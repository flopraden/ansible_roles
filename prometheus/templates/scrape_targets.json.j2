[
  {% for group in item.groups |default([])| sort %}
  {
    "targets": {{ groups.get(group,[]) | zip_longest([item.port]) | map('join',':') | list | to_json }},
    "labels": {
      "monitoring_group":  "{{ item.name }}"
    }
  },
  {% endfor %}
  {% if item.targets | default(false, true) %}
  {
    "targets": {{ item.targets | to_json }},
    "labels": {
      "monitoring_group":  "{{ item.name }}"
    }
  },
  {% endif %}
  {"targets": []}
]
